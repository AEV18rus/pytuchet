# Этапы внедрения выплат администратором

## Этап 2. Backend / API
- расширить модель выплат: `initiated_by`, `initiator_role`, `comment`, `method`, `source`, опционально `reversed_at` для откатов;
- создать endpoint `POST /api/payouts` (только админ), который валидирует сумму, фиксирует запись и возвращает обновлённый остаток;
- по завершении запроса пересчитывать агрегаты (остаток, итого) либо в базе, либо на лету через триггер/вью.

## Этап 3. История выплат
- в отчётах показывать последние выплаты по сотруднику с пометкой «Администратор»/«Мастер», суммой и комментарием;
- в личном кабинете мастера использовать тот же источник данных, чтобы видеть полную историю и кто инициировал запись;
- предусмотреть опцию отката/пометки, если админ исправляет ошибку.

## Этап 4. Доводка UI
- привести уведомления и статусы на странице отчётов и в ЛК к единому стилю (toast/баннеры);
- доработать кнопки/формы (размеры, доступность, мобильное поведение), добавить подсказки при вводе выплат;
- при необходимости сделать collapse/expand для истории, чтобы интерфейс оставался компактным.

## Этап 5. Тестирование и релиз
- прогнать сценарии: добавление выплаты, отмена, отображение в отчётах и ЛК на разных ширинах;
- убедиться, что API защищены правами (только админ), а записи корректно пишутся в историю;
- после проверки подготовить коммит и пуш с описанием изменений и инструкцией по обновлению.
